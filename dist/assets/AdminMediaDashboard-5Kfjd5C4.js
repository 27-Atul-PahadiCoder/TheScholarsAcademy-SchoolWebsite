import{c as g,j as e,r as n,i as j}from"./index-vIF-A6XC.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],ee=g("move",Z);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],f=g("plus",se);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ae=g("square-pen",te);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],le=g("trash-2",ne),y=({isOpen:a,onClose:t,children:l})=>a?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",children:e.jsx("div",{className:"bg-white p-5 rounded-lg shadow-lg w-1/3",children:l})}):null,oe=({isOpen:a,onClose:t,onRename:l,oldPath:c})=>{const[d,h]=n.useState(""),p=()=>{l(d),t()};return e.jsxs(y,{isOpen:a,onClose:t,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Rename Image"}),e.jsx("button",{onClick:t,children:e.jsx(f,{size:24,className:"transform rotate-45"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"fromPath",children:"From"}),e.jsx("input",{type:"text",id:"fromPath",value:c,readOnly:!0,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-200"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"toPath",children:"To (New Name)"}),e.jsx("input",{type:"text",id:"toPath",value:d,onChange:x=>h(x.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter the new file name"})]}),e.jsx("button",{onClick:p,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Rename"})]})},re=({isOpen:a,onClose:t,onChangePath:l,oldPath:c})=>{const[d,h]=n.useState(""),p=()=>{l(d),t()};return e.jsxs(y,{isOpen:a,onClose:t,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Change Image Path"}),e.jsx("button",{onClick:t,children:e.jsx(f,{size:24,className:"transform rotate-45"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"fromPath",children:"From"}),e.jsx("input",{type:"text",id:"fromPath",value:c,readOnly:!0,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-gray-200"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"toPath",children:"To (New Path)"}),e.jsx("input",{type:"text",id:"toPath",value:d,onChange:x=>h(x.target.value),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter the new file path"})]}),e.jsx("button",{onClick:p,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",children:"Change Path"})]})},ce=({isOpen:a,onClose:t,onDelete:l,path:c})=>{const d=()=>{l(),t()};return e.jsxs(y,{isOpen:a,onClose:t,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Delete Image"}),e.jsx("button",{onClick:t,children:e.jsx(f,{size:24,className:"transform rotate-45"})})]}),e.jsx("p",{className:"mb-4",children:"Are you sure you want to delete this image?"}),e.jsx("p",{className:"mb-4 bg-gray-100 p-2 rounded",children:c}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:t,className:"mr-2 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded",children:"Cancel"}),e.jsx("button",{onClick:d,className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"Delete"})]})]})},N="/api/media",de=async()=>{const a=await fetch(N,{headers:{...j()}});if(!a.ok)throw new Error("Failed to fetch media");return a.json()},ie=async(a,t)=>{const l=await fetch(`${N}/rename`,{method:"PATCH",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify({oldPath:a,newName:t})});return{...await l.json(),success:l.ok}},he=async(a,t)=>{const l=await fetch(`${N}/change-path`,{method:"PATCH",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify({oldPath:a,newPath:t})});return{...await l.json(),success:l.ok}},ue=async a=>{const t=await fetch(`${N}/delete`,{method:"DELETE",headers:{"Content-Type":"application/json",...j()},body:JSON.stringify({path:a})});return{...await t.json(),success:t.ok}},me=()=>{const[a,t]=n.useState([]),[l,c]=n.useState(!0),[d,h]=n.useState(!1),[p,x]=n.useState(!1),[E,w]=n.useState(!1),[F,v]=n.useState(!1),[o,k]=n.useState(null),[L,D]=n.useState(null),[C,z]=n.useState(""),[M,$]=n.useState(""),[P,_]=n.useState(""),[A,I]=n.useState(20),[S,O]=n.useState(null),[R,H]=n.useState(null);n.useEffect(()=>{(async()=>{try{c(!0);const m=(await de()).data.map(i=>({...i,status:"used",location:i.url.substring(0,i.url.lastIndexOf("/"))}));t(m)}catch(r){H(r.message)}finally{c(!1)}})()},[]);const b=(s,r)=>{O({message:s,type:r}),setTimeout(()=>{O(null)},5e3)},U=s=>{k(s),x(!0)},J=s=>{k(s),v(!0)},V=s=>{k(s),w(!0)},q=async s=>{if(o){const r=o.url,u=await ie(r,s);if(u.success){const m=a.map(i=>i.id===o.id?{...i,filename:s,url:i.url.substring(0,i.url.lastIndexOf("/")+1)+s}:i);t(m),b(u.message,"success")}else b(u.message,"error")}x(!1)},Q=async s=>{if(o){const r=await he(o.url,s);if(r.success){const u=a.map(m=>m.id===o.id?{...m,url:s}:m);t(u),b(r.message,"success")}else b(r.message,"error")}v(!1)},W=async()=>{if(o){const s=await ue(o.url);if(s.success){const r=a.filter(u=>u.id!==o.id);t(r),b(s.message,"success")}else b(s.message,"error")}w(!1)},B=s=>{s.target.files&&D(s.target.files[0])},G=s=>{z(s.target.value)},K=()=>{L&&C&&console.log(`Uploading ${L.name} to ${C}`),h(!1),D(null),z("")},T=a.filter(s=>s.filename.toLowerCase().includes(M.toLowerCase())||s.url.toLowerCase().includes(M.toLowerCase())).filter(s=>P?s.location===P:!0),X=[...new Set(a.map(s=>s.location))],Y=()=>{I(s=>s+20)};return l?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-blue-500"})}):R?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-red-500 text-2xl",children:R})}):e.jsxs("div",{className:"p-4",children:[" ",S&&e.jsx("div",{className:`fixed top-4 left-1/2 -translate-x-1/2 p-4 mb-4 text-white rounded shadow-lg z-50 ${S.type==="success"?"bg-green-500":"bg-red-500"}`,children:S.message}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Media Management"}),e.jsxs("button",{onClick:()=>h(!0),className:"bg-blue-500 text-white px-4 py-2 rounded flex items-center",children:[e.jsx(f,{size:20,className:"mr-2"}),"Add Media"]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by name or path",value:M,onChange:s=>$(s.target.value),className:"border p-2"}),e.jsxs("select",{value:P,onChange:s=>_(s.target.value),className:"border p-2",children:[e.jsx("option",{value:"",children:"All Locations"}),X.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-4 border-b",children:"Thumbnail"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Path"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Location"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Status"}),e.jsx("th",{className:"py-2 px-4 border-b",children:"Actions"})]})}),e.jsx("tbody",{children:T.slice(0,A).map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-4 border-b",children:s.mime_type.startsWith("image")?e.jsx("img",{src:s.url,alt:s.filename,className:"w-10 h-10 object-cover"}):e.jsx("video",{src:s.url,className:"w-10 h-10 object-cover"})}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.url}),e.jsx("td",{className:"py-2 px-4 border-b",children:s.location}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="used"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),e.jsx("td",{className:"py-2 px-4 border-b",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>U(s),className:"flex items-center bg-blue-500 hover:bg-blue-600 text-black font-bold py-2 px-4 rounded transition-colors duration-300",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Rename"]}),e.jsxs("button",{onClick:()=>J(s),className:"flex items-center bg-yellow-500 hover:bg-yellow-600 text-black font-bold py-2 px-4 rounded transition-colors duration-300",children:[e.jsx(ee,{size:16,className:"mr-2"}),"Change Path"]}),e.jsxs("button",{onClick:()=>V(s),className:"flex items-center bg-red-500 hover:bg-red-600 text-black font-bold py-2 px-4 rounded transition-colors duration-300",children:[e.jsx(le,{size:16,className:"mr-2"}),"Delete"]})]})})]},s.id))})]})}),A<T.length&&e.jsx("div",{className:"mt-4 text-center ",children:e.jsx("button",{onClick:Y,className:"bg-blue-500 text-white font-semibold px-8 py-4 rounded-full shadow-lg hover:scale-105 hover:shadow-xl hover:bg-blue-600 transition-all duration-500 ease-in-out focus:outline-none focus:ring-4 focus:ring-blue-500",children:"Show More"})}),e.jsxs(y,{isOpen:d,onClose:()=>h(!1),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Add New Media"}),e.jsx("button",{onClick:()=>h(!1),children:e.jsx(f,{size:24,className:"transform rotate-45"})})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("input",{type:"file",onChange:B}),e.jsx("input",{type:"text",placeholder:"Location",value:C,onChange:G,className:"border p-2"}),e.jsx("button",{onClick:K,className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Upload"})]})]}),e.jsx(oe,{isOpen:p,onClose:()=>x(!1),onRename:q,oldPath:o?.filename||""}),e.jsx(re,{isOpen:F,onClose:()=>v(!1),onChangePath:Q,oldPath:o?.url||""}),e.jsx(ce,{isOpen:E,onClose:()=>w(!1),onDelete:W,path:o?.url||""})]})};export{me as default};
